## 9장. HTTP에 기능을 추가한 프로토콜

## HTTP를 기본으로 하는 프로토콜

HTTP의 규격이 만들어졌을때 주로 HTML로 작성된 문서를 전송하기 위한 프로토콜로 HTTP를 생각했었다.

그렇게 시대에 거치면서 웹의 용도는 변화하면서 쇼핑 사이트, SNS, 기업이나 조직 내의 각종 관리 툴 등으로 사용합니다.  

<br/>

### 하지만

```
기능이 충분하다고 하더라도 효율적이라고는 할 수는 없습니다.
```

 

## HTTP라는 프로토콜의 제한이나 한계가 있다.

그것을 보완하는 전혀 새로운 프로토콜을 만들 수도 있지만, 

이미 웹 브라우저라는 환경이 널리 퍼진 지금 HTTP라는 프로토콜을 무시할 수 없습니다.

HTTP를 기반으로 해서 여기에 추가하는 형태로 새로운 프로토콜이 몇가지 구현되어 있다.

<br/><br/>

## HTTP의 병목 현상을 해소하는 SPDY

HTTP의 병목 현상을 해소하고 웹 페이지 로딩 시간을 50% 단축한다는 목표를 세우고 개발 되었다고 한다.

<br/>

## HTTP의 병목 현상

페이스북이나 트위터 등의 SNS는 많은 사람들이 작성한 정보를 거의 실시간으로 보는 것 중 하나라고 한다.

수백만 명, 수천만 명의 유저가 메시지 등의 정보를 작성하면 웹 사이트에 

그 정보들이 추가되면서 단시간에 대량의 갱신 정보가 발생한다.

<br/>

실시간으로 표시하기 위해서는 서버상의 정보가 갱신되었을때, 

그것을 클라이언트의 화면에 반영할 필요가 있다.

<br/>

HTTP에서는 서버의 정보가 갱신되었는지 아닌지를 알기 위해서 클라이언트가 항상 서버 측에 확인하러 가야한다.

만약 서버 상의 정보가 갱신되지 않은 경우에는 불필요한 통신이 발생하게 된다.

<br/><br/>

## Ajax에 의한 해결 방법

조작 등을 활용하는 방식으로, 웹 페이지의 일부분만 고쳐쓸 수 있는 비동기 통신 방법이다.

동기식 통신에 비해서 페이지의 일부분만 갱신되기 때문에 리스폰스로 전송되는 데이터 양은 줄어든다는 장점이 있다.

<br/>

Ajax의 핵심 기술은 XMLHttpRequest라는 API로 JavaScript 등의 스크립트 언어로 서버와 HTTP 통신을 할 수 있다. 

이미 읽어 들인 웹 페이지부터 리퀘스트를 발행할 수 있기 때문에 페이지의 일부 데이터만 받는 것이 가능하게 된다.

<br/><br/>

## Comet에 의한 해결 방법

클라이언트부터 리퀘스트를 기다리지 않고 클라이언트에 보내기 위한 방법이다.

응답을 연장시킴으로써, 서버에서 통신을 개시하는 서버 푸시 기능을 유사하게 따르고 있다.


<br/>

서버의 콘텐츠가 갱신되었을 때에 리스폰스를 반환한다는 것이다.

콘텐츠를 실시간으로 갱신할 수는 있지만 리스폰스를 보류하기 위해서 커넥션을 유지하는 시간이 길어진다.

```
커넥션을 유지하는 동안은 리소스를 소비해야한다.
```

<br/><br/>

## SPDY의 목표

Ajax와 Comet 등 사용성을 쾌적하게 하는 여러 가지 기술이 등장해서 어느 정도 개선되었지만, 

HTTP라는 프로토콜의 제약은 없앨 수는 없다. 



SPDY는 HTTP가 안고 있던 병목 현상을 프로토콜 레벨에서 해소하기 위해 개발이 진행되고 있는 프로토콜이다.

<br/><br/>

## SPDY 설계와 기능

SPDY는 HTTP를 완전히 바꿔 놓는 것이 아니라 TCP/IP의 애플리케이션 계층과 트랜스포트 계층 사이에 

새로운 세션 계층을 추가하는 형태로 동작한다.

<br/><br/>

## SPDY는 보안을 위해서 표준으로 SSL을 사용하도록 되어 있다.

SPDY가 세션 계층으로서 그 사이에 들어감으로써 데이터의 흐름을 제어하지만, HTTP의 커넥션은 확립되어 있다.

그리하여 HTTP의 GET이나 POST 같은 메소드나 쿠키, HTTP 메시지 등을 그대로 사용할 수 있다.

<br/><br/>

## 리퀘스트의 우선 순위 부여

SPDY는 무제한으로 리퀘스트를 병렬 처리할 수 있지만, 각 리퀘스트에 우선순위를 할당할 수 있다.

대역폭이 좁으면 처리가 늦어지는 현상을 해결하기 위해서 이다.

<br/><br/>

## HTTP 헤더 압축

리퀘스트와 리스폰스의 HTTP 헤더를 압축한다.

적은 패킷수와 송신 바이트 수료 통신을 할 수 있다.

<br/><br/>

## 서버 푸시 기능

서버 측은 클라이언트 측에서 리퀘스트를 기다리지 않고 데이터를 보낼 수 있다.

<br/><br/>

## 서버 힌트 기능

서버가 클라이언트에게 리퀘스트 해야 할 리소스를 제안할 수 있다.

클라이언트가 지원을 발견하기 전에 리소스의 존재를 알 수 있기 때문에 이미 캐시를 가지고 있는 상태라면 

불필요한 리퀘스트를 보내지 않아도 된다.

<br/><br/>

## SPDY는 웹의 병목 현상을 해결하는가?

SPDY는 HTTP의 병목 현상을 해결하는 좋은 기술이지만, 대부분 웹 사이트의 문제는 HTTP의 병목 현상 때문만은 아니다. 

웹 자신을 고속화하기 위해서는 웹 콘텐츠 제작을 개선하는 등 부수적으로 해야 할 일이 많다.

<br/><br/>

## 브라우저에서 양뱡향 통신을 하는 WebSocket

Ajax와 Coment을 사용한 통신은 웹 브라우징을 고속화하지만 HTTP라는 프로토콜을 사용하고 있는 이상, 병목 현상을 해결할 수 없다.

<br/><br/>

## WebSocket의 설계와 기능

주로 Ajax나 Comet에서 사용하는 XMLHttpRequset의 결점을 해결하기 위한 기술로서 개발이 진행되고 있다.

<br/><br/>

## WebSocket 프로토콜

WebSocket은 웹 서버와 클라이너트가 한번 접속을 확립하면 통신을 모두 전용 프로토콜로 하는 방식으로 


JSON이나 XML, HTML이나 이미지등 임의 형식의 데이터를 보내게 된다.

한번 접속을 확립하면 WebSocket을 사용하여 서버와 클라이언트 어느 쪽에서도 송신을 할 수 있게 된다.

<br/><br/>


## 서버 푸시 기능

서버에서 클라이언트에 데이터를 푸시하는 서버 푸시 기능을 제공한다.

<br/><br/>

## 통신량의 삭감

WebSocket은 접속을 한번 확립하면 접속을 유지하려고 한다.

오버헤드가 적어지고, 또 헤더의 사이즈도 작기 때문에 통신량을 줄일 수 있다.

<br/><br/>

## HTTP/2.0의 특징

HTTP/2.0은 사용자가 웹을 이용할 때의 체감 속도의 개선을 목표로 하고 있다.

Network-Friendly HTTP Upgrade는 주로 모바일 통신에서 HTTP의 효율 개선을 위한 규격이다.

<br/><br/>

## 웹 서버 상의 파일을 관리하는 WebDAV

직접 파일 복사나 편집 작업 등을 할 수 있는 분산 파일 시스템으로 HTTP/1.1를 확장한 프로토콜로 정의되어 있다. 

파일 작성자 등의 관리나 편집중에 다른 유저가 다시 고쳐 쓰지 못하도록 잠금 가능, 갱신 정보를 관리하는 리비전 기능 등이 있다.

<br/><br/>

## HTTP/1.1을 확장한 WebDAV

- 컬렉션 : 여러 개의 리소스를 한꺼번에 관리하기 위한 개념이다.

- 자원 : 파일이나 컬렉션을 리소스라고 부른다.
- 프로퍼티 : 리소스의 프로퍼티를 정의한 것이다. 정의는 “이름=값”의 형식이다.
- 잠금 : 파일을 편집할 수 없는 상태로 한다. 여러 명의 사람이 동시에 편집하는 경우 등 동시에 작성되는 걸 예방한다.

<br/>

```
102 Processing : 리퀘스트는 정상적으로 수신되었지만 아직 처리 중이다.

207 Multi-Status : 복수의 스테이터스를 가지고 있다.

422 Unprocessable Entity : 서식은 올바르지만 내용이 틀리다.

423 Failed Dependency : 어떤 리퀘스트와 관련된 리퀘스트가 실패했기 때문에 의존 관계를 유지 못한다.

507 Insufficient Storage : 기억 영역이 부족하다.
```

<br/><br/>

## 왜 HTTP는 이렇게까지 사용되고 있는가?

많은 이유 중의 하나로 기업이나 조직 등의 방화벽 설정과 크게 관련되어 있다.

방화벽의 기본 기능 중에 지정된 프로토콜이나 포트 번호 이외의 패킷은 통과 시키지 않는다는 기능이 있어,

이로 인해 새로운 프로토콜이나 포트 번호를 이용하는 경우에는 설정을 변경할 필요가 생긴다.

<br/>

웹은 HTTP에서 동작하고 있기 때문에 웹 서버의 구축할 때나 웹 사이트에의 액세스에는 

방화벽의 설정에서 HTTP이나 HTTPS를 허가해 둘 필요가 있다고 한다.

이것이 HTTP를 기반으로 하는 서비스와 콘텐츠가 늘어나고 있는 이유라고 한다.

다른 이유로는 HTTP 클라이언트인 브라우저가 보급되어 있는 것이나 HTTP 서버가 많이 보급되고 있는 것 등의 이유도 같다.

<br/><br/>

>**Reference** 
> <br/> [
그림으로 배우는 HTTP & Network](http://www.yes24.com/Product/Goods/15894097)


